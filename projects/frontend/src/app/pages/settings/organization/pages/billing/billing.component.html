<app-organisation-form-billing [organisation]="organisation"></app-organisation-form-billing>

<div>
  <label class="section-text pb-3">Locations</label>

  <!-- Botón para abrir el modal -->
  <div class="fv-row fv-plugins-icon-container px-1 pt-3 pb-5">
    <a class="btn btn-sm fw-bold border-0 px-0" (click)="addLocation(locationModal)">
      <span class="btn-label" [inlineSVG]="'./assets/media/icons/duotune/general/add-plus.svg'"></span>
      <span class="a-link-color ps-3 fs-5 align-middle">{{ "buttons.addLocations" | translate }}</span>
    </a>
  </div>

  <!-- Modal -->
  <ng-template #locationModal>
    <div class="modal-content">
      <div class="modal-header px-9">
        <label class="popover-title"
               id="ModalLabel1">{{ editingMode ? 'Edit Location' : 'Add Location' }}</label>
        <button type="button" class="btn-close" (click)="locationModalRef.hide()" aria-label="Close"></button>
      </div>
      <form [formGroup]="locationForm" (ngSubmit)="onSubmitLocation()">
        <div class="modal-body pt-3 pb-5">
          <!-- Aquí coloca los campos del formulario -->

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.location'"
                     [placeholder]="'labels.addLocation'"
                     formControlName="location">
          </app-input>

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.address'"
                     [placeholder]="'labels.addAddress'"
                     formControlName="address">
          </app-input>

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.phone'"
                     [placeholder]="'labels.addPhone'"
                     formControlName="phone">
          </app-input>

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.tmsRefNo'"
                     [placeholder]="'labels.addtsmRefNo'"
                     formControlName="tsmRefNo">
          </app-input>
        </div>
        <div class="modal-footer py-3">

          <app-button class="px-0" data-bs-dismiss="modal" [name]="'buttons.cancel'" (click)="locationModalRef.hide()"
                      [btnColor]="btnColor.filterButtonWhiteBg"></app-button>
          <ng-container *ngIf="!editingMode">
            <app-button class="px-0" [name]="'buttons.create'" [disabled]="!locationForm.valid"
                        [btnColor]="btnColor.filterButton"></app-button>
          </ng-container>
          <ng-container *ngIf="editingMode">
            <app-button class="px-0" (click)="updateLocationRow();locationModalRef.hide()" [name]="'buttons.updateForm'"
                        [disabled]="!locationForm.valid" [btnColor]="btnColor.filterButton"></app-button>
          </ng-container>
        </div>
      </form>
    </div>
  </ng-template>
</div>

<!-- Tabla para mostrar los datos ingresados -->
<table class="table table-bordered table-striped table-hover fs-6 gy-2 mb-6" *ngIf="showLocationTable">
  <thead>
  <tr class="fs-7">
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 28%">Location</th>
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 28%">Address</th>
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 28%">Phone</th>
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 16%">TMS ref. no.</th>
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 16%">Maintenance</th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let data of locationsData; let i = index" [ngClass]="{'selected-row': i === selectedRowIndex}">
    <td class="py-0 center-vertically">{{ data.location }}</td>
    <td class="py-0 center-vertically">{{ data.address }}</td>
    <td class="py-0 center-vertically">{{ data.phone }}</td>
    <td class="py-0 center-vertically">{{ data.tsmRefNo }}</td>
    <td class="py-0">
      <!--      <button class="btn btn-sm btn-info me-2" (click)="editRow(i)">Edit</button>-->
      <!--      <button class="btn btn-sm btn-danger" (click)="deleteRow(i)">Delete</button>-->
      <app-action [name]="'edit'" (click)="editLocationRow(i, locationModal);"></app-action>
      <app-action [name]="'delete'"
                  (click)="openDeleteLocationConfirmationModal(i, deleteLocationConfirmationModal);locationModalRef.hide()"></app-action>
    </td>
  </tr>
  </tbody>
</table>


<ng-template #deleteLocationConfirmationModal>
  <div class="modal-content" style="z-index: 101">
    <div class="modal-header">
      <span class="btn-label" [inlineSVG]="'./assets/media/icons/duotune/general/warning-popover.svg'"></span>
      <label class="popover-title-warning ps-3">
        Attention</label>
      <button type="button" class="btn-close" (click)="deleteLocationConfirmationModalRef.hide()"
              aria-label="Close"></button>
    </div>
    <div class="modal-body">
      <div class="d-flex align-items-center">
        <label class="text-modal-body">Are you sure you want to delete all information?</label>
      </div>
    </div>
    <div class="modal-footer">

      <app-button class="px-0" data-bs-dismiss="modal" [name]="'buttons.cancel'"
                  (click)="deleteLocationConfirmationModalRef.hide()"
                  [btnColor]="btnColor.filterButtonWhiteBg"></app-button>
      <app-button class="px-0" [name]="'buttons.yes'"
                  (click)="deleteLocationRow(rowToDeleteIndex); deleteLocationConfirmationModalRef.hide()"
                  [btnColor]="btnColor.filterButton"></app-button>
    </div>
  </div>
  <bs-modal-backdrop style="z-index: 100" class="modal-backdrop fade show"></bs-modal-backdrop>
</ng-template>

<div>
  <label class="section-text pb-3">Language aliases</label>

  <!-- Botón para abrir el modal -->
  <div class="fv-row fv-plugins-icon-container px-1 pt-3">
    <a class="btn btn-sm fw-bold border-0 px-0" (click)="addLanguage(languageModal)">
      <span class="btn-label" [inlineSVG]="'./assets/media/icons/duotune/general/add-plus.svg'"></span>
      <span class="a-link-color ps-3 fs-5 align-middle">{{ "buttons.addLanguage" | translate }}</span>
    </a>
  </div>

  <!-- Modal -->
  <ng-template #languageModal>
    <div class="modal-content">
      <div class="modal-header px-9">
        <label class="popover-title"
               id="ModalLabel">{{ editingMode ? 'Edit Language' : 'Add Language' }}</label>
        <button type="button" class="btn-close" (click)="languageModalRef.hide()" aria-label="Close"></button>
      </div>
      <form [formGroup]="languageForm" (ngSubmit)="onSubmitLanguage()">
        <div class="modal-body pt-3 pb-5">

          <app-select class="row d-flex w-100 pe-2 pt-0 mx-1 salutation" [options]="languages"
                      [placeholder]="'labels.addLanguage'"
                      [label]="'labels.language'"
                      formControlName="language">
          </app-select>

          <app-select class="row d-flex w-100 pe-2 pt-0 mx-1 salutation" [options]="type"
                      [placeholder]="'labels.addType'"
                      [label]="'labels.type'"
                      formControlName="type">
          </app-select>

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.alias'"
                     [placeholder]="'labels.addAlias'"
                     formControlName="alias">
          </app-input>
        </div>
        <div class="modal-footer py-3">

          <app-button class="px-0" data-bs-dismiss="modal" [name]="'buttons.cancel'" (click)="languageModalRef.hide()"
                      [btnColor]="btnColor.filterButtonWhiteBg"></app-button>
          <ng-container *ngIf="!editingMode">
            <app-button class="px-0" [name]="'buttons.create'" [disabled]="!languageForm.valid"
                        [btnColor]="btnColor.filterButton"></app-button>
          </ng-container>
          <ng-container *ngIf="editingMode">
            <app-button class="px-0" (click)="updateLanguageRow();languageModalRef.hide()" [name]="'buttons.updateForm'"
                        [disabled]="!languageForm.valid" [btnColor]="btnColor.filterButton"></app-button>
          </ng-container>
        </div>
      </form>

    </div>
  </ng-template>
</div>

<!-- Tabla para mostrar los datos ingresados -->
<table class="table table-bordered table-striped table-hover mb-0 fs-6 gy-2" *ngIf="showLanguageTable">
  <thead>
  <tr class="fs-7">
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 28%">Language</th>
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 28%">Type</th>
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 28%">Alias</th>
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 16%">Maintenance</th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let data of languagesData; let i = index" [ngClass]="{'selected-row': i === selectedRowIndex}">
    <td class="py-0 center-vertically">{{ getLanguageName(data.language) }}</td>
    <td class="py-0 center-vertically">{{ getTypeName(data.type) }}</td>
    <td class="py-0 center-vertically">{{ data.alias }}</td>
    <td class="py-0">
      <!--      <button class="btn btn-sm btn-info me-2" (click)="editRow(i)">Edit</button>-->
      <!--      <button class="btn btn-sm btn-danger" (click)="deleteRow(i)">Delete</button>-->
      <app-action [name]="'edit'" (click)="editLanguageRow(i, languageModal);"></app-action>
      <app-action [name]="'delete'"
                  (click)="openDeleteLanguageConfirmationModal(i, deleteLanguageConfirmationModal);languageModalRef.hide()"></app-action>
    </td>
  </tr>
  </tbody>
</table>


<ng-template #deleteLanguageConfirmationModal>
  <div class="modal-content" style="z-index: 101">
    <div class="modal-header">
      <span class="btn-label" [inlineSVG]="'./assets/media/icons/duotune/general/warning-popover.svg'"></span>
      <label class="popover-title-warning ps-3">
        Attention</label>
      <button type="button" class="btn-close" (click)="deleteLanguageConfirmationModalRef.hide()"
              aria-label="Close"></button>
    </div>
    <div class="modal-body">
      <div class="d-flex align-items-center">
        <label class="text-modal-body">Are you sure you want to delete all information?</label>
      </div>
    </div>
    <div class="modal-footer">

      <app-button class="px-0" data-bs-dismiss="modal" [name]="'buttons.cancel'"
                  (click)="deleteLanguageConfirmationModalRef.hide()"
                  [btnColor]="btnColor.filterButtonWhiteBg"></app-button>
      <app-button class="px-0" [name]="'buttons.yes'"
                  (click)="deleteLanguageRow(rowToDeleteIndex); deleteLanguageConfirmationModalRef.hide()"
                  [btnColor]="btnColor.filterButton"></app-button>
    </div>
  </div>
  <bs-modal-backdrop style="z-index: 100" class="modal-backdrop fade show"></bs-modal-backdrop>
</ng-template>
