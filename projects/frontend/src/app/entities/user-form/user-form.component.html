<form [formGroup]="userForm">
  <div class="row ">
    <div class="col-xxl-8 col-md-7">
      <label class="section-text pb-3">Personal info
        <app-action (click)="onEditActive()" [name]="'edit'"></app-action>
      </label>

      <div class="mb-0 pb-0 fv-row fv-plugins-icon-container pb-2">
        <div class="d-flex gap-3">
          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.firstName'" [placeholder]="''"
                     [disabled]="!isEditing"
                     formControlName="firstName"
                     [isInvalid]="userForm.controls.firstName.invalid && (userForm.controls.firstName.dirty || userForm.controls.firstName.touched)">
          </app-input>

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.lastName'" [placeholder]="''"
                     [disabled]="!isEditing"
                     formControlName="lastName"
                     [isInvalid]="userForm.controls.lastName.invalid && (userForm.controls.lastName.dirty || userForm.controls.lastName.touched)">
          </app-input>

        </div>

        <div class="d-flex"
             [ngClass]="{'justify-content-end': userForm.controls.lastName.invalid && (userForm.controls.lastName.dirty || userForm.controls.lastName.touched)}">
          <div
            *ngIf="userForm.controls.firstName.invalid && (userForm.controls.firstName.dirty || userForm.controls.firstName.touched)"
            class="text-danger w-50">
            <div *ngIf="userForm.controls.firstName.errors.required">The field First Name is mandatory.</div>
            <div *ngIf="userForm.controls.firstName.errors.pattern">The field First Name accepts only letters.</div>
          </div>
          <div
            *ngIf="userForm.controls.lastName.invalid && (userForm.controls.lastName.dirty || userForm.controls.lastName.touched)"
            class="text-danger w-50">
            <div *ngIf="userForm.controls.lastName.errors.required">The field Last Name is mandatory.</div>
            <div *ngIf="userForm.controls.lastName.errors.pattern">The field Last Name accepts only letters.</div>
          </div>
        </div>
      </div>

      <div class="mb-0 fv-row fv-plugins-icon-container pb-2">
        <div class="d-flex gap-3">

          <app-select class="row d-flex w-30 pe-2 pt-0 mx-1 salutation" [options]="salutations" [disabled]="!isEditing"
                      [label]="'labels.salutation'"
                      formControlName="salutation">
          </app-select>

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.jobTitle'" [placeholder]="''"
                     [disabled]="!isEditing"
                     formControlName="jobTitle"
                     [isInvalid]="userForm.controls.jobTitle.invalid && (userForm.controls.jobTitle.dirty || userForm.controls.jobTitle.touched)">
          </app-input>

        </div>

        <div class="d-flex justify-content-end">
          <div
            *ngIf="userForm.controls.jobTitle.invalid && (userForm.controls.jobTitle.dirty || userForm.controls.jobTitle.touched)"
            class="text-danger w-75 ps-14">
            <div *ngIf="userForm.controls.jobTitle.errors.required">The field Job Title is mandatory.</div>
            <div *ngIf="userForm.controls.jobTitle.errors.pattern">The field Job Title accepts only letters.</div>
          </div>
        </div>
      </div>

      <div class="mb-0 fv-row fv-plugins-icon-container pb-2">
        <div class="d-flex gap-3">

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.mobilePhone'" [placeholder]="''"
                     [disabled]="!isEditing"
                     formControlName="mobilePhone"
                     [isInvalid]="userForm.controls.mobilePhone.invalid && (userForm.controls.mobilePhone.dirty || userForm.controls.mobilePhone.touched)">
          </app-input>

        </div>

        <div
          *ngIf="userForm.controls.mobilePhone.invalid && (userForm.controls.mobilePhone.dirty || userForm.controls.mobilePhone.touched)"
          class="text-danger">
          <div *ngIf="userForm.controls.mobilePhone.errors.required">The field Mobile Phone is mandatory.</div>
          <div *ngIf="userForm.controls.mobilePhone.errors.pattern">The field Mobile Phone accepts only numbers.</div>
        </div>

      </div>

      <div class="mb-0 fv-row fv-plugins-icon-container pb-2">
        <div class="d-flex gap-3">

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.officePhone'" [placeholder]="''"
                     [disabled]="!isEditing"
                     formControlName="officePhone"
                     [isInvalid]="userForm.controls.officePhone.invalid && (userForm.controls.officePhone.dirty || userForm.controls.officePhone.touched)">
          </app-input>

        </div>

        <div
          *ngIf="userForm.controls.officePhone.invalid && (userForm.controls.officePhone.dirty || userForm.controls.officePhone.touched)"
          class="text-danger">
          <div *ngIf="userForm.controls.officePhone.errors.required">The field Office Phone is mandatory.</div>
          <div *ngIf="userForm.controls.officePhone.errors.pattern">The field Office Phone accepts only numbers.</div>
        </div>

      </div>

      <div class="fv-row fv-plugins-icon-container pb-2">
        <div class="d-flex gap-3">

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.primaryWorkLocation'" [placeholder]="''"
                     [disabled]="!isEditing"
                     formControlName="workLocation"
                     [isInvalid]="userForm.controls.workLocation.invalid && (userForm.controls.workLocation.dirty || userForm.controls.workLocation.touched)">
          </app-input>

        </div>

        <div
          *ngIf="userForm.controls.workLocation.invalid && (userForm.controls.workLocation.dirty || userForm.controls.workLocation.touched)"
          class="text-danger">
          <div *ngIf="userForm.controls.workLocation.errors.required">The field Primary Work Location is mandatory.
          </div>
          <div *ngIf="userForm.controls.workLocation.errors.pattern">Please enter a valid Work Location.</div>
        </div>

      </div>

      <div class="fv-row fv-plugins-icon-container pb-2">
        <div class="d-flex gap-3">

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.linkedin'" [placeholder]="'Profile link'"
                     [disabled]="!isEditing"
                     formControlName="linkedin">
          </app-input>

        </div>

      </div>

      <div class="d-flex g-3 justify-content-end pt-3 mb-0" *ngIf="isEditing">

        <div class="col-xxl-1 col-xl-2 col-lg-3 col-md-3 col-sm-3 min-w-100px">
          <app-button (click)="onEditInactive()" [name]="'buttons.cancel'" [btnColor]="btnColor.cancelForm"></app-button>
        </div>

        <div class="col-xxl-2 col-xl-3 col-lg-4 col-md-4 col-sm-4">
          <app-button (click)="cancel.emit()" [name]="'buttons.updateForm'" [btnColor]="btnColor.updateForm"></app-button>
        </div>

      </div>

      <label class="section-text pb-3">Account info</label>

      <div class="mb-0 pb-0 fv-row fv-plugins-icon-container pb-2">
        <div class="d-flex gap-3">
          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.emailAddress'" [placeholder]="''"
                     [disabled]="true"
                     formControlName="emailAddress">
          </app-input>

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.createdOn'" [placeholder]="''"
                     [disabled]="true"
                     formControlName="createdOn">
          </app-input>

        </div>
      </div>

      <div class="mb-0 pb-0 fv-row fv-plugins-icon-container pb-2">
        <div class="d-flex gap-3">
          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.primUserID'" [placeholder]="''"
                     [disabled]="true"
                     formControlName="primaryUserID">
          </app-input>

          <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.secUserID'" [placeholder]="''"
                     [disabled]="true"
                     formControlName="secondaryUserID">
          </app-input>

        </div>
      </div>

      <div class="mb-0 fv-row fv-plugins-icon-container pb-2">
        <div class="d-flex gap-3">

          <app-select class="row d-flex w-100 pe-2 pt-0 mx-1 salutation" [options]="timeZones"
                      [label]="'labels.timeZone'" [disabled]="true"
                      formControlName="timeZone">
          </app-select>


        </div>

      </div>

      <!--      <div class="row g-3 justify-content-end pt-3 mb-0">-->

      <!--        <div class="col-md-3">-->
      <!--          <app-button (click)="save.emit()" [name]="'buttons.save'" [btnColor]="btnColor.blue"-->
      <!--                      [disabled]="!userForm.valid"></app-button>-->
      <!--        </div>-->

      <!--        <div class="col-md-3" *ngIf="isManagement">-->
      <!--          <app-button (click)="cancel.emit()" [name]="'buttons.cancel'" [btnColor]="btnColor.white"></app-button>-->
      <!--        </div>-->

      <!--      </div>-->


    </div>
    <div class="card col-xxl-4 col-md-5 px-4">
      <div class="text-center px-2 pt-2 image-container border-radius-5px">

        <div class="div-img">
          <div class="image-input img-fluid image-input-empty image-input-outline image-input-placeholder mt-12" data-kt-image-input="true">
            <div class="image-input-wrapper img-fluid w-150px h-150px"
                 [style.background-image]="'url(' + (userForm.controls.avatar.value || defaultAvatar) + ')'">
              <div class="d-flex image-hover-overlay justify-content-center gap-3">
                <span class="edit-option">Edit</span>
                <div class="divider"></div>
                <span class="delete-option">Delete</span>
              </div>
            </div>
          </div>
          <div class="profile-picture pt-3 pb-1 gap-3" style="">
            <span class="change-text">Change Picture</span>
            <input type="file" id="fileInput" hidden>
            <label for="fileInput">
              <app-action [name]="'edit'"></app-action>
            </label>
          </div>
        </div>

        <div class="pb-5 mt-3 fs-6 border-radius-3px" style="border-radius: 3px !important;">
          <div class="text-white text-start border-radius-top py-2 px-4 fw-medium user-full-name mx-2">{{
            userForm.controls.fullName.value || 'Lisa M. B.' }}
          </div>


          <div class="row d-flex mx-2 bg-white border-radius-bottom">
            <ng-container *ngIf="userForm.controls.role.value">
              <!--              <div class="text-start fw-bold toolbar-title-text mt-3 fs-6 px-3">{{ userForm.controls.role.value }}</div>-->

              <div class="text-start toolbar-title-text px-6 pt-2 pb">
                {{ "userRoles.admin" | translate }}
              </div>

            </ng-container>

            <div class="d-flex gap-sm-3 gap-xxl-8 px-6">
              <app-datepicker formControlName="birthday" [bgColor]="'white'"
                              class="row w-100 justify-content-start fv-row mt-0"
                              [label]="'labels.birthDay'">
              </app-datepicker>

              <div class="row mb-0 w-100">
                <app-switch class="birthday-switch gap-2" [bgColor]="bgColor.gray"
                            [checked]="userForm.get('showBirthday').value"
                            [label]="'labels.showBirthday'">
                </app-switch>
              </div>
            </div>

            <div>
              <app-textarea class="row d-flex w-100 px-3 pt-0 mx-0 pb-3" [label]="'labels.about'"
                            [placeholder]="'users.aboutDescriptionUser'"
                            formControlName="aboutDescription">
              </app-textarea>
            </div>
          </div>

          <!--          <div-->
          <!--            class="fw-bold text-start text-gray-400 fs-7 mx-4 mt-0">{{ "users.birthdayDescription" | translate }}</div>-->
        </div>
      </div>
    </div>

    <div>
      <label class="section-text pb-3">Language aliases</label>

      <!-- Botón para abrir el modal -->
      <div class="fv-row fv-plugins-icon-container px-1 pt-3 pb-4">
        <a class="btn btn-sm fw-bold border-0 px-0" (click)="addLanguage(myModal)">
          <span class="btn-label" [inlineSVG]="'./assets/media/icons/duotune/general/add-plus.svg'"></span>
          <span class="a-link-color ps-3 fs-5 align-middle">{{ "buttons.addLanguage" | translate }}</span>
        </a>
      </div>

      <!-- Modal -->
      <ng-template #myModal>
        <div class="modal-content">
          <div class="modal-header px-9">
            <label class="popover-title"
                   id="ModalLabel">{{ editingMode ? 'Edit Language' : 'Add Language' }}</label>
            <button type="button" class="btn-close" (click)="modalRef.hide()" aria-label="Close"></button>
          </div>
          <form [formGroup]="languageForm" (ngSubmit)="onSubmit();modalRef.hide()">
            <div class="modal-body pt-3 pb-5">

              <app-select class="row d-flex w-100 pe-2 pt-0 mx-1 salutation" [options]="languages"
                          [placeholder]="'labels.addLanguage'"
                          [label]="'labels.language'"
                          formControlName="language">
              </app-select>

              <app-select class="row d-flex w-100 pe-2 pt-0 mx-1 salutation" [options]="type"
                          [placeholder]="'labels.addType'"
                          [label]="'labels.type'"
                          formControlName="type">
              </app-select>

              <app-input class="row d-flex w-100 pe-2 pt-0 mx-1" [label]="'labels.alias'"
                         [placeholder]="'labels.addAlias'" formControlName="alias"
                         [isInvalid]="languageForm.controls.alias.invalid && (languageForm.controls.alias.dirty || languageForm.controls.alias.touched)">
              </app-input>

              <div
                *ngIf="languageForm.controls.alias.invalid && (languageForm.controls.alias.dirty || languageForm.controls.alias.touched)"
                class="text-danger">
                <div *ngIf="languageForm.controls.alias.errors.required">The field Alias is mandatory.</div>
                <div *ngIf="languageForm.controls.alias.errors.pattern">The field Alias accepts only letters.</div>
              </div>
            </div>
            <div class="modal-footer py-3">

              <app-button class="px-0" data-bs-dismiss="modal" [name]="'buttons.cancel'" (click)="modalRef.hide()"
                          [btnColor]="btnColor.filterButtonWhiteBg"></app-button>
              <ng-container *ngIf="!editingMode">
                <app-button class="px-0" [name]="'buttons.create'" [disabled]="!languageForm.valid"
                            [btnColor]="btnColor.filterButton"></app-button>
              </ng-container>
              <ng-container *ngIf="editingMode">
                <app-button class="px-0" (click)="updateRow();modalRef.hide()" [name]="'buttons.updateForm'"
                            [disabled]="!languageForm.valid" [btnColor]="btnColor.filterButton"></app-button>
              </ng-container>
            </div>
          </form>

        </div>
      </ng-template>
    </div>
  </div>
</form>

<!-- Tabla para mostrar los datos ingresados -->
<table class="table table-bordered table-striped table-hover mb-0 fs-6 gy-2" *ngIf="showTable">
  <thead>
  <tr class="fs-7">
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 28%">Language</th>
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 28%">Type</th>
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 28%">Alias</th>
    <th class="p-lg-2 sorting padding-cells-thead" style="width: 16%">Maintenance</th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let data of languagesData; let i = index" [ngClass]="{'selected-row': i === selectedRowIndex}">
    <td class="py-0 center-vertically">{{ getLanguageName(data.language) }}</td>
    <td class="py-0 center-vertically">{{ getTypeName(data.type) }}</td>
    <td class="py-0 center-vertically">{{ data.alias }}</td>
    <td class="py-0">
      <!--      <button class="btn btn-sm btn-info me-2" (click)="editRow(i)">Edit</button>-->
      <!--      <button class="btn btn-sm btn-danger" (click)="deleteRow(i)">Delete</button>-->
      <app-action [name]="'edit'" (click)="editRow(i, myModal);"></app-action>
      <app-action [name]="'delete'"
                  (click)="openDeleteConfirmationModal(i, deleteConfirmationModal);modalRef.hide()"></app-action>
    </td>
  </tr>
  </tbody>
</table>


<ng-template #deleteConfirmationModal>
  <div class="modal-content" style="z-index: 101">
    <div class="modal-header">
      <span class="btn-label" [inlineSVG]="'./assets/media/icons/duotune/general/warning-popover.svg'"></span>
      <label class="popover-title-warning ps-3">
        Attention</label>
      <button type="button" class="btn-close" (click)="deleteConfirmationModalRef.hide()" aria-label="Close"></button>
    </div>
    <div class="modal-body">
      <div class="d-flex align-items-center">
        <label class="text-modal-body">Are you sure you want to delete all information?</label>
      </div>
    </div>
    <div class="modal-footer">

      <app-button class="px-0" data-bs-dismiss="modal" [name]="'buttons.cancel'"
                  (click)="deleteConfirmationModalRef.hide()"
                  [btnColor]="btnColor.filterButtonWhiteBg"></app-button>
      <app-button class="px-0" [name]="'buttons.yes'"
                  (click)="deleteRow(rowToDeleteIndex); deleteConfirmationModalRef.hide()"
                  [btnColor]="btnColor.filterButton"></app-button>
    </div>
  </div>
  <bs-modal-backdrop style="z-index: 100" class="modal-backdrop fade show"></bs-modal-backdrop>
</ng-template>

<!--<ng-template #toggle let-role="role">-->
<!--  <app-switch class="col-lg-8" [checked]="userForm.get('roles').value.includes(role.value)" [label]="role.name">-->
<!--  </app-switch>-->
<!--</ng-template>-->


